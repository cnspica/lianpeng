(function(){var c;$(".search").submit(function(){var j=$(this).find(".query").val();var i=$(this).attr("action")+j;if(c){c.navigate(i,{trigger:true})}else{window.location.href=i}return false});$("#feedback .confirm").click(function(){if($(this).hasClass("disabled")){return false}$(this).addClass("disabled");var j=$("#feedback textarea").val();var i={text:j};i=JSON.stringify(i);$.ajax({url:"/api/v1/feedback/",data:i,type:"POST",contentType:"application/json",dataType:"application/json"}).complete(function(){$("#feedback textarea").hide();$("#feedback .success").show()});return false});$("#feedback").on("hidden",function(){$("#feedback textarea").val("");$("#feedback .confirm").removeClass("disabled");$("#feedback textarea").show();$("#feedback .success").hide()});F={fetch_title:function(i,j){$.post("/harvest/pageinfo/",{url:i},j)},url_domain:function(j){var i=document.getElementById("url-template");i.href=j;var k=i.hostname;if(i.port&&i.port!=80){k+=":"+i.port}return k},form2json:function(j){var k={};var i=$(j).serializeArray();$.each(i,function(){if(k[this.name]!==undefined){if(!k[this.name].push){k[this.name]=[k[this.name]]}k[this.name].push(this.value||"")}else{k[this.name]=this.value||""}});return k},show_paginator:function(i,k,l){var j=i;if(j.collection.total_count>j.collection.paginationConfig.ipp){j.$(".paginator").pagination({total_pages:Math.ceil(j.collection.total_count/j.collection.paginationConfig.ipp),current_page:j.collection.currentPage,display_max:k,callback:function(m,n){l();j.collection.loadPage(n)}}).show()}else{j.$(".paginator").hide()}}};$.fn.spin=function(i){this.each(function(){var k=$(this),j=k.data();if(j.spinner){j.spinner.stop();delete j.spinner}if(i!==false){j.spinner=new Spinner($.extend({color:k.css("color")},i)).spin(this)}});return this};var a="/api/v1/user/"+USER_ID;var h=Backbone.Model.extend({urlRoot:"/api/v1/bookmark/"});var f=Backbone.Collection.extend({parse:function(i){this.total_count=i.meta.total_count;return i.objects}});var e=Backbone.Model.extend({urlRoot:"/api/v1/list/"});var d=e.extend({});var g=f.extend({model:e,initialize:function(){Backbone.Pagination.enable(this,{page_attr:"offset",ipp:100,ipp_attr:"limit"})},baseUrl:"/api/v1/list/"});var b=Backbone.View.extend({events:{"click .list-name":"redirect"},initialize:function(){var i=this;this.model.bind("destroy",this.delete_model,this);this.model.bind("change",this.change_name,this);this.$el.droppable({accept:".bookmark-entry-box",tolerance:"pointer",drop:_.bind(function(l,m){var k=$(l.target);var j=$(m.draggable).data("id");var n=$(m.draggable).data("list-id");i.trigger("dropped",n,j,i.model);$(m.draggable).remove()},this),over:_.bind(function(k,l){var j=$(k.target);if(j.hasClass("active")){j.addClass("source")}else{j.addClass("active")}},this),out:_.bind(function(k,l){var j=$(k.target);if(!j.hasClass("source")){j.removeClass("active")}},this)})},delete_model:function(){this.remove();$("#all-list .list-name").click()},redirect:function(){var i=USER_NAME+"/list/"+this.model.id;if(Backbone.history.fragment==i){Backbone.history.fragment=null}Backbone.history.navigate(i,true)},render:function(){var k=this.model;var j=$("#list-bookmarks-tmpl").html();var i=_.template(j,{list:k.toJSON()});$("#bookmarks").html(i);$("#bookmarks").spin();this.bookmarks=new Bookmarks({list:this.model});this.bookmarks.bind("reset",this.stop_spin,this);this.model.bookmarks=this.bookmarks;this.bookmarks_view=new BookmarksView({collection:this.bookmarks,el:"#bookmarks #list-bookmarks-"+this.model.id+" .bookmarks",list:this.model});this.bookmarks.fetch();this.list_setting_view=new ListSettingView({el:"#bookmarks #list-bookmarks-"+this.model.id+" .list-header",model:this.model});$("#lists li").removeClass("active");this.$el.addClass("active")},stop_spin:function(){$("#bookmarks").spin(false)},change_name:function(){this.$(".list-name .name-text").text(this.model.get("name"))}})}).call(this);