(function(){var i;$(".search").submit(function(){var m=$(this).find(".query").val();var l=$(this).attr("action")+m;if(i){i.navigate(l,{trigger:true})}else{window.location.href=l}return false});$("#feedback .confirm").click(function(){if($(this).hasClass("disabled")){return false}$(this).addClass("disabled");var m=$("#feedback textarea").val();var l={text:m};l=JSON.stringify(l);$.ajax({url:"/api/v1/feedback/",data:l,type:"POST",contentType:"application/json",dataType:"application/json"}).complete(function(){$("#feedback textarea").hide();$("#feedback .success").show()});return false});$("#feedback").on("hidden",function(){$("#feedback textarea").val("");$("#feedback .confirm").removeClass("disabled");$("#feedback textarea").show();$("#feedback .success").hide()});F={fetch_title:function(l,m){$.post("/harvest/pageinfo/",{url:l},m)},url_domain:function(m){var l=document.getElementById("url-template");l.href=m;var n=l.hostname;if(l.port&&l.port!=80){n+=":"+l.port}return n},form2json:function(m){var n={};var l=$(m).serializeArray();$.each(l,function(){if(n[this.name]!==undefined){if(!n[this.name].push){n[this.name]=[n[this.name]]}n[this.name].push(this.value||"")}else{n[this.name]=this.value||""}});return n},show_paginator:function(l,n,o){var m=l;if(m.collection.total_count>m.collection.paginationConfig.ipp){m.$(".paginator").pagination({total_pages:Math.ceil(m.collection.total_count/m.collection.paginationConfig.ipp),current_page:m.collection.currentPage,display_max:n,callback:function(p,q){o();m.collection.loadPage(q)}}).show()}else{m.$(".paginator").hide()}}};$.fn.spin=function(l){this.each(function(){var n=$(this),m=n.data();if(m.spinner){m.spinner.stop();delete m.spinner}if(l!==false){m.spinner=new Spinner($.extend({color:n.css("color")},l)).spin(this)}});return this};var g="/api/v1/user/"+USER_ID;var b=Backbone.Model.extend({urlRoot:"/api/v1/bookmark/"});var a=Backbone.Collection.extend({parse:function(l){this.total_count=l.meta.total_count;return l.objects}});var k=Backbone.Model.extend({urlRoot:"/api/v1/list/"});var h=k.extend({});var f=a.extend({model:k,initialize:function(){Backbone.Pagination.enable(this,{page_attr:"offset",ipp:100,ipp_attr:"limit"})},baseUrl:"/api/v1/list/"});var d=Backbone.View.extend({events:{"click .list-name":"redirect"},initialize:function(){var l=this;this.model.bind("destroy",this.delete_model,this);this.model.bind("change",this.change_name,this);this.$el.droppable({accept:".bookmark-entry-box",tolerance:"pointer",drop:_.bind(function(o,p){var n=$(o.target);var m=$(p.draggable).data("id");var q=$(p.draggable).data("list-id");l.trigger("dropped",q,m,l.model);$(p.draggable).remove()},this),over:_.bind(function(n,o){var m=$(n.target);if(m.hasClass("active")){m.addClass("source")}else{m.addClass("active")}},this),out:_.bind(function(n,o){var m=$(n.target);if(!m.hasClass("source")){m.removeClass("active")}},this)})},delete_model:function(){this.remove();$("#all-list .list-name").click()},redirect:function(){var l=USER_NAME+"/list/"+this.model.id;if(Backbone.history.fragment==l){Backbone.history.fragment=null}Backbone.history.navigate(l,true)},render:function(){var n=this.model;var m=$("#list-bookmarks-tmpl").html();var l=_.template(m,{list:n.toJSON()});$("#bookmarks").html(l);$("#bookmarks").spin();this.bookmarks=new Bookmarks({list:this.model});this.bookmarks.bind("reset",this.stop_spin,this);this.model.bookmarks=this.bookmarks;this.bookmarks_view=new BookmarksView({collection:this.bookmarks,el:"#bookmarks #list-bookmarks-"+this.model.id+" .bookmarks",list:this.model});this.bookmarks.fetch();this.list_setting_view=new ListSettingView({el:"#bookmarks #list-bookmarks-"+this.model.id+" .list-header",model:this.model});$("#lists li").removeClass("active");this.$el.addClass("active")},stop_spin:function(){$("#bookmarks").spin(false)},change_name:function(){this.$(".list-name .name-text").text(this.model.get("name"))}});var j=d.extend({initialize:function(){}});var e=d.extend({render:function(){d.prototype.render.call(this);$(".add-bookmark-form-box").hide();$(".list-setting-box").hide()}});var c=e.extend({})}).call(this);